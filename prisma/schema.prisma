generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["jsonProtocol"]
}

datasource db {
  provider          = "postgresql"
  url               = env("POSTGRES_PRISMA_URL")
  directUrl         = env("POSTGRES_URL_NON_POOLING")
  shadowDatabaseUrl = env("POSTGRES_URL_NON_POOLING")
}

model User {
  id       Int    @id @default(autoincrement())
  email    String @unique
  password String
}

model Bandwidth {
  id                                    Int      @id @default(autoincrement())
  time                                  DateTime @default(now())
  server_id                             Int      @unique
  app_id                                Int      @unique
  servername                            String
  appname                               String
  // HTTP User bandwidth send by country
  TotalBandwidthByCountry_Vietnam       BigInt   @default(0)
  TotalBandwidthByCountry_US            BigInt   @default(0)
  TotalBandwidthByCountry_Myanmar       BigInt   @default(0)
  TotalBandwidthByCountry_International BigInt   @default(0)
  TotalBandwidthByCountry_Other         BigInt   @default(0)
  TotalBandwidthByCountry_Notfound      BigInt   @default(0)
  // HTTP User bandwidth send by ISP
  TotalBandwidthByIsp_Viettel           BigInt   @default(0)
  TotalBandwidthByIsp_Mobi              BigInt   @default(0)
  TotalBandwidthByIsp_Vina              BigInt   @default(0)
  TotalBandwidthByIsp_FPT               BigInt   @default(0)
  TotalBandwidthByIsp_Other             BigInt   @default(0)
  TotalBandwidthByIsp_Unknown           BigInt   @default(0)
  // HTTP User bandwidth
  TotalBandwidthReceiveClientHTTP       BigInt   @default(0)
  TotalBandwidthSendClientHTTP          BigInt   @default(0)
  TotalBandwidthReceiveClientHTTP2      BigInt   @default(0)
  TotalBandwidthSendClientHTTP2         BigInt   @default(0)
  // 
  TotalBandwidthReceiveClientHTTPS      BigInt   @default(0)
  TotalBandwidthSendClientHTTPS         BigInt   @default(0)
  // Download bandwidth
  TotalBandwidthReceiveDownload         BigInt   @default(0)
  TotalBandwidthSendDownload            BigInt   @default(0)
}

// Tab HTTPS Bandwidth
model HTTPSBandwidth {
  id                                             Int      @id @default(autoincrement())
  time                                           DateTime @default(now())
  server_id                                      Int      @unique
  app_id                                         Int      @unique
  servername                                     String
  appname                                        String
  // TotalBandwidthSendClientHTTPS
  TotalBandwidthSendHTTPS_Outbound               BigInt   @default(0)
  // TotalBandwidthReceiveClientHTTPS
  TotalBandwidthRecvHTTPS_Inbound                BigInt   @default(0)
  // TotalBandwidthByCountry
  TotalBandwidthSendHTTPSByCountry_Vietnam       BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_US            BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_Myanmar       BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_International BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_Other         BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_NotFound      BigInt   @default(0)
  // TotalBandwidthByIsp
  TotalBandwidthSendHTTPSByIsp_Viettel           BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Mobi              BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Vina              BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_FPT               BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Other             BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Unknown           BigInt   @default(0)
  // 
  DataUsageSendHTTPS_Outbound                    BigInt   @default(0)
  DataUsageRecvHTTPS_Inbound                     BigInt   @default(0)
  // 
  DataUsageHTTPSByCountry_Vietnam                BigInt   @default(0)
  DataUsageHTTPSByCountry_US                     BigInt   @default(0)
  DataUsageHTTPSByCountry_Myanmar                BigInt   @default(0)
  DataUsageHTTPSByCountry_International          BigInt   @default(0)
  DataUsageHTTPSByCountry_Other                  BigInt   @default(0)
  DataUsageHTTPSByCountry_NotFound               BigInt   @default(0)
  // 
  DataUsageSendHTTPSByIsp_Viettel                BigInt   @default(0)
  DataUsageHTTPSByIsp_Mobi                       BigInt   @default(0)
  DataUsageHTTPSByIsp_Vina                       BigInt   @default(0)
  DataUsageHTTPSByIsp_FPT                        BigInt   @default(0)
  DataUsageHTTPSByIsp_Other                      BigInt   @default(0)
  DataUsageHTTPSByIsp_Unknown                    BigInt   @default(0)
}

// Tab HTTP2 Bandwidth
model HTTP2Bandwidth {
  id                                             Int      @id @default(autoincrement())
  time                                           DateTime @default(now())
  server_id                                      Int      @unique
  app_id                                         Int      @unique
  servername                                     String
  appname                                        String
  // TotalBandwidthSendClientHTTP2
  TotalBandwidthSendHTTP2_Outbound               BigInt   @default(0)
  // TotalBandwidthReceiveClientHTTP2
  TotalBandwidthRecvHTTP2_Inbound                BigInt   @default(0)
  // TotalBandwidthByCountry
  TotalBandwidthSendHTTP2ByCountry_Vietnam       BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_US            BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_Myanmar       BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_International BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_Other         BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_NotFound      BigInt   @default(0)
  // TotalBandwidthByIsp
  TotalBandwidthSendHTTP2ByIsp_Viettel           BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Mobi              BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Vina              BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_FPT               BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Other             BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Unknown           BigInt   @default(0)
  // 
  TotalDataUsageSendHTTP2_Outbound               BigInt   @default(0)
  TotalDataUsageRecvHTTP2_Inbound                BigInt   @default(0)
  // 
  TotalDataUsageHTTP2ByCountry_Vietnam           BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_US                BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_Myanmar           BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_International     BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_Other             BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_NotFound          BigInt   @default(0)
  // 
  TotalDataUsageHTTP2ByIsp_Viettel               BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Mobi                  BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Vina                  BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_FPT                   BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Other                 BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Unknown               BigInt   @default(0)
}

// Tab Cache
model Cache {
  id                    Int      @id @default(autoincrement())
  time                  DateTime @default(now())
  server_id             Int      @unique
  app_id                Int      @unique
  servername            String
  appname               String
  PercentMemHitTotal    BigInt   @default(0)
  PercentDiskHitTotal   BigInt   @default(0)
  // Calculate by PercentMemHit and PercentDiskHit
  PercentMissCacheTotal BigInt   @default(0)
  TotalMemHit           BigInt   @default(0)
  TotalDiskHit          BigInt   @default(0)
  TotalRequestHTTP      BigInt   @default(0)
  TotalRequestHTTPS     BigInt   @default(0)
  TotalRequestHTTP2     BigInt   @default(0)
}

// Tab Download
model Response {
  id                                    Int      @id @default(autoincrement())
  time                                  DateTime @default(now())
  server_id                             Int      @unique
  app_id                                Int      @unique
  servername                            String
  appname                               String
  TotalConnDownload                     BigInt   @default(0)
  TotalRequestDownload                  BigInt   @default(0)
  TotalRequestDownloadRetry             BigInt   @default(0)
  TotalCCUDownload                      BigInt   @default(0)
  TotalCCURequestDownload               BigInt   @default(0)
  RecentTimeDownload                    BigInt   @default(0)
  ConnPoolsDownload_PoolSize            BigInt   @default(0)
  ConnPoolsDownload_MaxPoolSize         BigInt   @default(0)
  ConnPoolsDownload_TotalBorrow         BigInt   @default(0)
  ConnPoolsDownload_TotalInvalid        BigInt   @default(0)
  ConnPoolsDownload_TotalConnectFailed  BigInt   @default(0)
  ConnPoolsDownload_TotalConnectSuccess BigInt   @default(0)
}

// Tab Internal download
model InternalDownload {
  id                                    Int      @id @default(autoincrement())
  time                                  DateTime @default(now())
  server_id                             Int      @unique
  app_id                                Int      @unique
  servername                            String
  appname                               String
  TotalRequestDownloadInternal          BigInt   @default(0)
  TotalRequestDownloadInternalRetry     BigInt   @default(0)
  TotalCCURequestDownloadInternal       BigInt   @default(0)
  TotalCCUDownloadInternal              BigInt   @default(0)
  TotalCloseDownloadInternal            BigInt   @default(0)
  TotalConnDownloadInternal             BigInt   @default(0)
  RecentTimeDownloadInternal            BigInt   @default(0)
  TotalBandwidthReceiveDownloadInternal BigInt   @default(0)
  TotalBandwidthSendDownloadInternal    BigInt   @default(0)
  TotalBandwidthReceiveClientInternal   BigInt   @default(0)
  TotalBandwidthSendClientInternal      BigInt   @default(0)
}

// Tab Overlay download
// Empty chart

model HTTPStatusCode {
  id           Int      @id @default(autoincrement())
  time         DateTime @default(now())
  server_id    Int      @unique
  app_id       Int      @unique
  servername   String
  appname      String
  Total200     BigInt   @default(0)
  Total301     BigInt   @default(0)
  Total302     BigInt   @default(0)
  Total304     BigInt   @default(0)
  Total400     BigInt   @default(0)
  Total403     BigInt   @default(0)
  Total404     BigInt   @default(0)
  Total500     BigInt   @default(0)
  Total502     BigInt   @default(0)
  TotalClose   BigInt   @default(0)
  TotalUnknown BigInt   @default(0)
}

// Tab HTTP - HTTP2 ErrorCode
model HTTP2ErrorCode {
  id                        Int      @id @default(autoincrement())
  time                      DateTime @default(now())
  server_id                 Int      @unique
  app_id                    Int      @unique
  servername                String
  appname                   String
  TotalRcvProtocolError     BigInt   @default(0)
  TotalRcvCancel            BigInt   @default(0)
  TotalRcvCompressionError  BigInt   @default(0)
  TotalRcvFlowControlError  BigInt   @default(0)
  TotalRcvFrameSizeError    BigInt   @default(0)
  TotalRcvInternalError     BigInt   @default(0)
  TotalRcvRefusedStream     BigInt   @default(0)
  TotalRcvSettingTimeout    BigInt   @default(0)
  TotalRcvStreamClose       BigInt   @default(0)
  TotalSendProtocolError    BigInt   @default(0)
  TotalSendCancel           BigInt   @default(0)
  TotalSendCompressionError BigInt   @default(0)
  TotalSendFlowControlError BigInt   @default(0)
  TotalSendFrameSizeError   BigInt   @default(0)
  TotalSendInternalError    BigInt   @default(0)
  TotalSendRefusedStream    BigInt   @default(0)
  TotalSendSettingTimeout   BigInt   @default(0)
  TotalSendStreamClose      BigInt   @default(0)
}

// Tab response
// Empty chart

// Tab connection
model Connection {
  id                     Int      @id @default(autoincrement())
  time                   DateTime @default(now())
  server_id              Int      @unique
  app_id                 Int      @unique
  servername             String
  appname                String
  RespondConnsCliHTTP    BigInt   @default(0)
  RespondConnsCliHTTPS   BigInt   @default(0)
  RespondConnsCliHTTP2   BigInt   @default(0)
  KeepAliveConnsCliHTTP  BigInt   @default(0)
  KeepAliveConnsCliHTTPS BigInt   @default(0)
  KeepAliveConnsCliHTTP2 BigInt   @default(0)
  KeepAliveConnsDownload BigInt   @default(0)
}
