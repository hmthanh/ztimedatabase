generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["jsonProtocol"]
}

datasource db {
  provider          = "postgresql"
  url               = env("POSTGRES_PRISMA_URL")
  directUrl         = env("POSTGRES_URL_NON_POOLING")
  shadowDatabaseUrl = env("POSTGRES_URL_NON_POOLING")
}

model Bandwidth {
  time                                  DateTime @id @default(now()) @db.Timestamptz(6)
  serverId                              Int
  appId                                 Int
  TotalBandwidthByCountry_Vietnam       BigInt   @default(0)
  TotalBandwidthByCountry_US            BigInt   @default(0)
  TotalBandwidthByCountry_Myanmar       BigInt   @default(0)
  TotalBandwidthByCountry_International BigInt   @default(0)
  TotalBandwidthByCountry_Other         BigInt   @default(0)
  TotalBandwidthByCountry_Notfound      BigInt   @default(0)
  TotalBandwidthByIsp_Viettel           BigInt   @default(0)
  TotalBandwidthByIsp_Mobi              BigInt   @default(0)
  TotalBandwidthByIsp_Vina              BigInt   @default(0)
  TotalBandwidthByIsp_FPT               BigInt   @default(0)
  TotalBandwidthByIsp_Other             BigInt   @default(0)
  TotalBandwidthByIsp_Unknown           BigInt   @default(0)
  TotalBandwidthReceiveClientHTTP       BigInt   @default(0)
  TotalBandwidthSendClientHTTP          BigInt   @default(0)
  TotalBandwidthReceiveClientHTTP2      BigInt   @default(0)
  TotalBandwidthSendClientHTTP2         BigInt   @default(0)
  TotalBandwidthReceiveClientHTTPS      BigInt   @default(0)
  TotalBandwidthSendClientHTTPS         BigInt   @default(0)
  TotalBandwidthReceiveDownload         BigInt   @default(0)
  TotalBandwidthSendDownload            BigInt   @default(0)

  @@index([time, serverId, appId])
}

model HTTPSBandwidth {
  time                                           DateTime @id @default(now()) @db.Timestamptz(6)
  serverId                                       Int
  appId                                          Int
  TotalBandwidthSendHTTPS_Outbound               BigInt   @default(0)
  TotalBandwidthRecvHTTPS_Inbound                BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_Vietnam       BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_US            BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_Myanmar       BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_International BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_Other         BigInt   @default(0)
  TotalBandwidthSendHTTPSByCountry_NotFound      BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Viettel           BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Mobi              BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Vina              BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_FPT               BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Other             BigInt   @default(0)
  TotalBandwidthSendHTTPSByIsp_Unknown           BigInt   @default(0)
  DataUsageSendHTTPS_Outbound                    BigInt   @default(0)
  DataUsageRecvHTTPS_Inbound                     BigInt   @default(0)
  DataUsageHTTPSByCountry_Vietnam                BigInt   @default(0)
  DataUsageHTTPSByCountry_US                     BigInt   @default(0)
  DataUsageHTTPSByCountry_Myanmar                BigInt   @default(0)
  DataUsageHTTPSByCountry_International          BigInt   @default(0)
  DataUsageHTTPSByCountry_Other                  BigInt   @default(0)
  DataUsageHTTPSByCountry_NotFound               BigInt   @default(0)
  DataUsageSendHTTPSByIsp_Viettel                BigInt   @default(0)
  DataUsageHTTPSByIsp_Mobi                       BigInt   @default(0)
  DataUsageHTTPSByIsp_Vina                       BigInt   @default(0)
  DataUsageHTTPSByIsp_FPT                        BigInt   @default(0)
  DataUsageHTTPSByIsp_Other                      BigInt   @default(0)
  DataUsageHTTPSByIsp_Unknown                    BigInt   @default(0)

  @@index([time, serverId, appId])
}

model HTTP2Bandwidth {
  time                                           DateTime @id @default(now()) @db.Timestamptz(6)
  serverId                                       Int
  appId                                          Int
  TotalBandwidthSendHTTP2_Outbound               BigInt   @default(0)
  TotalBandwidthRecvHTTP2_Inbound                BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_Vietnam       BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_US            BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_Myanmar       BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_International BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_Other         BigInt   @default(0)
  TotalBandwidthSendHTTP2ByCountry_NotFound      BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Viettel           BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Mobi              BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Vina              BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_FPT               BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Other             BigInt   @default(0)
  TotalBandwidthSendHTTP2ByIsp_Unknown           BigInt   @default(0)
  TotalDataUsageSendHTTP2_Outbound               BigInt   @default(0)
  TotalDataUsageRecvHTTP2_Inbound                BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_Vietnam           BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_US                BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_Myanmar           BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_International     BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_Other             BigInt   @default(0)
  TotalDataUsageHTTP2ByCountry_NotFound          BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Viettel               BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Mobi                  BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Vina                  BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_FPT                   BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Other                 BigInt   @default(0)
  TotalDataUsageHTTP2ByIsp_Unknown               BigInt   @default(0)

  @@index([time, serverId, appId])
}

model Cache {
  time                  DateTime @id @default(now()) @db.Timestamptz(6)
  serverId              Int
  appId                 Int
  PercentMemHitTotal    BigInt   @default(0)
  PercentDiskHitTotal   BigInt   @default(0)
  PercentMissCacheTotal BigInt   @default(0)
  TotalMemHit           BigInt   @default(0)
  TotalDiskHit          BigInt   @default(0)
  TotalRequestHTTP      BigInt   @default(0)
  TotalRequestHTTPS     BigInt   @default(0)
  TotalRequestHTTP2     BigInt   @default(0)

  @@index([time, serverId, appId])
}

model Download {
  time                                  DateTime @id @default(now()) @db.Timestamptz(6)
  serverId                              Int
  appId                                 Int
  TotalConnDownload                     BigInt   @default(0)
  TotalRequestDownload                  BigInt   @default(0)
  TotalRequestDownloadRetry             BigInt   @default(0)
  TotalCCUDownload                      BigInt   @default(0)
  TotalCCURequestDownload               BigInt   @default(0)
  RecentTimeDownload                    BigInt   @default(0)
  ConnPoolsDownload_PoolSize            BigInt   @default(0)
  ConnPoolsDownload_MaxPoolSize         BigInt   @default(0)
  ConnPoolsDownload_TotalBorrow         BigInt   @default(0)
  ConnPoolsDownload_TotalInvalid        BigInt   @default(0)
  ConnPoolsDownload_TotalConnectFailed  BigInt   @default(0)
  ConnPoolsDownload_TotalConnectSuccess BigInt   @default(0)

  @@index([time, serverId, appId])
}

model InternalDownload {
  time                                  DateTime @id @default(now()) @db.Timestamptz(6)
  serverId                              Int
  appId                                 Int
  TotalRequestDownloadInternal          BigInt   @default(0)
  TotalRequestDownloadInternalRetry     BigInt   @default(0)
  TotalCCURequestDownloadInternal       BigInt   @default(0)
  TotalCCUDownloadInternal              BigInt   @default(0)
  TotalCloseDownloadInternal            BigInt   @default(0)
  TotalConnDownloadInternal             BigInt   @default(0)
  RecentTimeDownloadInternal            BigInt   @default(0)
  TotalBandwidthReceiveDownloadInternal BigInt   @default(0)
  TotalBandwidthSendDownloadInternal    BigInt   @default(0)
  TotalBandwidthReceiveClientInternal   BigInt   @default(0)
  TotalBandwidthSendClientInternal      BigInt   @default(0)

  @@index([time, serverId, appId])
}

model HTTPStatusCode {
  time         DateTime @id @default(now()) @db.Timestamptz(6)
  serverId     Int
  appId        Int
  Total200     BigInt   @default(0)
  Total301     BigInt   @default(0)
  Total302     BigInt   @default(0)
  Total304     BigInt   @default(0)
  Total400     BigInt   @default(0)
  Total403     BigInt   @default(0)
  Total404     BigInt   @default(0)
  Total500     BigInt   @default(0)
  Total502     BigInt   @default(0)
  TotalClose   BigInt   @default(0)
  TotalUnknown BigInt   @default(0)

  @@index([time, serverId, appId])
}

model HTTP2ErrorCode {
  time                      DateTime @id @default(now()) @db.Timestamptz(6)
  serverId                  Int
  appId                     Int
  TotalRcvProtocolError     BigInt   @default(0)
  TotalRcvCancel            BigInt   @default(0)
  TotalRcvCompressionError  BigInt   @default(0)
  TotalRcvFlowControlError  BigInt   @default(0)
  TotalRcvFrameSizeError    BigInt   @default(0)
  TotalRcvInternalError     BigInt   @default(0)
  TotalRcvRefusedStream     BigInt   @default(0)
  TotalRcvSettingTimeout    BigInt   @default(0)
  TotalRcvStreamClose       BigInt   @default(0)
  TotalSendProtocolError    BigInt   @default(0)
  TotalSendCancel           BigInt   @default(0)
  TotalSendCompressionError BigInt   @default(0)
  TotalSendFlowControlError BigInt   @default(0)
  TotalSendFrameSizeError   BigInt   @default(0)
  TotalSendInternalError    BigInt   @default(0)
  TotalSendRefusedStream    BigInt   @default(0)
  TotalSendSettingTimeout   BigInt   @default(0)
  TotalSendStreamClose      BigInt   @default(0)

  @@index([time, serverId, appId])
}

model Connection {
  time                   DateTime @id @default(now()) @db.Timestamptz(6)
  serverId               Int
  appId                  Int
  RespondConnsCliHTTP    BigInt   @default(0)
  RespondConnsCliHTTPS   BigInt   @default(0)
  RespondConnsCliHTTP2   BigInt   @default(0)
  KeepAliveConnsCliHTTP  BigInt   @default(0)
  KeepAliveConnsCliHTTPS BigInt   @default(0)
  KeepAliveConnsCliHTTP2 BigInt   @default(0)
  KeepAliveConnsDownload BigInt   @default(0)

  @@index([time, serverId, appId])
}
